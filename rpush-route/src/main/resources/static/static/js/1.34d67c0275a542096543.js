webpackJsonp([1],{En30:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=s("Dd8w"),a=s.n(n),i=s("BO1k"),r=s.n(i),c=s("Xxa5"),o=s.n(c),l=s("exGp"),d=s.n(l),u=s("S+hO"),v=s("zL8q"),p={name:"groupManagement",components:{},data:function(){return{keyword:"",menuListActive:{},menuList:[],configs:[],groups:[],inputReceiverId:"",addReceiverIds:[],model:{configIds:[],groupIds:[],sendTos:[]},sendMessageParam:{platformParam:{},title:"",content:""}}},mounted:function(){var e=this;return d()(o.a.mark(function t(){return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.platformList();case 2:case"end":return t.stop()}},t,e)}))()},methods:{handleAddReceiverId:function(){var e=this;this.$nextTick(function(){e.$refs.inputReceiverId.focus()});var t=new RegExp(this.menuListActive.validateReg).test(this.inputReceiverId);t||v.Message.error("格式校验不正确"),!this.inputReceiverId||this.addReceiverIds.indexOf(this.inputReceiverId)>=0||!t||(this.addReceiverIds.push(this.inputReceiverId),this.inputReceiverId="")},handleClearAddReceiverId:function(){var e=this;this.$nextTick(function(){e.$refs.inputReceiverId.focus()}),this.addReceiverIds=[]},handleAddReceiverIdClose:function(e){var t=this;this.$nextTick(function(){t.$refs.inputReceiverId.focus()}),this.addReceiverIds.splice(this.addReceiverIds.indexOf(e),1)},routeTo:function(e){if(e){var t=!0,s=!1,n=void 0;try{for(var a,i=r()(this.menuList);!(t=(a=i.next()).done);t=!0){var c=a.value;c.id===e&&(this.menuListActive=c)}}catch(e){s=!0,n=e}finally{try{!t&&i.return&&i.return()}finally{if(s)throw n}}}else this.menuListActive=this.menuList[0];this.queryConfig(),this.queryGroup()},platformList:function(){var e=this;return d()(o.a.mark(function t(){var s;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(u.i)({keyword:e.keyword,pageNo:1,pageSize:999});case 2:0===(s=t.sent).code&&(e.menuList=s.data,e.routeTo(e.menuListActive.id||e.$route.query.platform));case 4:case"end":return t.stop()}},t,e)}))()},queryConfig:function(){var e=this;return d()(o.a.mark(function t(){var s,n;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(u.j)(e.menuListActive.id,{pageSize:2147483647});case 2:for(s=t.sent,e.configs=s.data.pagination.dataList,e.model.configIds=[],n=0;n<e.configs.length;n++)e.configs[n].defaultFlag&&e.model.configIds.push(e.configs[n].configId);case 6:case"end":return t.stop()}},t,e)}))()},queryGroup:function(){var e=this;return d()(o.a.mark(function t(){var s;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(u.l)(e.menuListActive.id,{pageSize:2147483647});case 2:s=t.sent,e.groups=s.data.dataList;case 4:case"end":return t.stop()}},t,e)}))()},sendMessage:function(){var e=this;return d()(o.a.mark(function t(){var s;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e.model.configIds.length){t.next=3;break}return v.Message.error("请选择至少一个配置"),t.abrupt("return");case 3:return e.model.sendTos.push.apply(e.model.sendTos,e.addReceiverIds),e.sendMessageParam.platformParam[e.menuListActive.id]=a()({},e.model),t.next=7,Object(u.o)(e.sendMessageParam);case 7:s=t.sent,Object(v.Message)({message:s.data||"服务器异常",type:"success"});case 9:case"end":return t.stop()}},t,e)}))()}}},m={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"taskManagement"},[e._m(0),e._v(" "),s("div",{staticClass:"taskManagement_container"},[s("div",{staticClass:"tm_c_wrap"},[s("div",{staticClass:"tm_c_menu"},[s("div",{staticClass:"tm_c_menu_option"},[e._m(1),e._v(" "),s("div",{staticClass:"tm_c_menu_search"},[s("el-input",{attrs:{size:"mini",placeholder:"请输入平台名称",clearable:""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.platformList(t)}},model:{value:e.keyword,callback:function(t){e.keyword=t},expression:"keyword"}},[s("el-button",{attrs:{slot:"append",size:"mini",icon:"el-icon-search"},on:{click:e.platformList},slot:"append"})],1)],1)]),e._v(" "),s("div",{staticClass:"tm_c_menu_list"},e._l(e.menuList,function(t,n){return s("div",{key:n,staticClass:"item",class:e.menuListActive.id===t.id?"itemActive":"",on:{click:function(s){return e.routeTo(t.id)}}},[s("div",[e._v(e._s(t.name))])])}),0)]),e._v(" "),s("div",{staticClass:"tm_c_table"},[s("div",{staticClass:"setOfLayer"},[s("div",{staticClass:"features"},[s("span",{staticClass:"title"},[e._v(e._s(e.menuListActive.name))])]),e._v(" "),s("div",{staticClass:"remarks_box"},[e._v("\n            "+e._s(e.menuListActive.description)+"\n          ")]),e._v(" "),s("div",{staticClass:"table_layout fixedLayer"},[s("div",{staticClass:"setOfLayer"},[s("el-row",[s("el-col",{attrs:{span:24}},[e._v("\n                  选择配置：\n                  "),s("el-select",{attrs:{multiple:"",placeholder:"请选择配置..."},model:{value:e.model.configIds,callback:function(t){e.$set(e.model,"configIds",t)},expression:"model.configIds"}},e._l(e.configs,function(e){return s("el-option",{key:e.configId,attrs:{label:e.configName,value:e.configId}})}),1)],1)],1),e._v(" "),s("el-row",[s("el-col",{attrs:{span:24}},[e._v("\n                  选择分组：\n                  "),s("el-select",{attrs:{multiple:"",placeholder:"请选择分组..."},model:{value:e.model.groupIds,callback:function(t){e.$set(e.model,"groupIds",t)},expression:"model.groupIds"}},e._l(e.groups,function(e){return s("el-option",{key:e.id,attrs:{label:e.groupName,value:e.id}})}),1)],1)],1),e._v(" "),s("el-row",[s("el-col",{attrs:{span:6}},[s("el-input",{ref:"inputReceiverId",attrs:{size:"small",clearable:"",placeholder:"输入并回车补充接收人..."},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleAddReceiverId(t)}},model:{value:e.inputReceiverId,callback:function(t){e.inputReceiverId=t},expression:"inputReceiverId"}})],1),e._v(" "),s("el-col",{attrs:{span:15}},[s("el-button",{attrs:{type:"text",size:"small"},on:{click:e.handleClearAddReceiverId}},[e._v("清空")])],1),e._v(" "),s("el-col",{attrs:{span:24}},e._l(e.addReceiverIds,function(t){return s("el-tag",{key:t,staticStyle:{"margin-bottom":"2px","margin-left":"2px"},attrs:{size:"small",closable:"",type:"info"},on:{close:function(s){return e.handleAddReceiverIdClose(t)}}},[e._v("\n                    "+e._s(t)+"\n                  ")])}),1)],1),e._v(" "),s("el-row",[s("el-col",{attrs:{span:24}},[s("el-input",{attrs:{size:"small",type:"text",clearable:"",placeholder:"输入消息标题..."},model:{value:e.sendMessageParam.title,callback:function(t){e.$set(e.sendMessageParam,"title",t)},expression:"sendMessageParam.title"}})],1)],1),e._v(" "),s("el-row",{staticStyle:{"border-bottom":"0"}},[s("el-col",{attrs:{span:24}},[s("el-input",{attrs:{type:"textarea",clearable:"",autosize:{minRows:15,maxRows:100},placeholder:"输入消息正文..."},model:{value:e.sendMessageParam.content,callback:function(t){e.$set(e.sendMessageParam,"content",t)},expression:"sendMessageParam.content"}})],1)],1),e._v(" "),s("el-row",{staticStyle:{"border-bottom":"0","border-top":"1px solid #c3c6cc",position:"sticky",bottom:"0",background:"white"}},[s("el-col",{attrs:{span:24}},[s("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.sendMessage}},[e._v("发送")])],1)],1)],1)])])])])])])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"taskManagement_header"},[t("div",{staticClass:"title"},[this._v("发消息")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"tm_c_menu_top"},[t("div",{staticClass:"tm_c_menu_top_title"},[this._v("平台")])])}]};var f=s("VU/8")(p,m,!1,function(e){s("IKiW"),s("x+03")},"data-v-6477f7d1",null);t.default=f.exports},IKiW:function(e,t){},"x+03":function(e,t){}});
//# sourceMappingURL=1.34d67c0275a542096543.js.map